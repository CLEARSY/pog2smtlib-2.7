name: Check Test References

on:
  push:
    paths:
      - 'test/output/reference/**/*.smt'
  pull_request:
    paths:
      - 'test/output/reference/**/*.smt'

jobs:
  smtlib-27-check:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/clearsy/dolmen:latest

    steps:
      - name: Checkout code
        run: |
          git clone https://github.com/${{ github.repository }}.git .
          git checkout ${{ github.sha }}

      - name: Run smtlib-27 check
        run: |
          scripts/check_reference_files.sh test/output/reference
